# Updated requirements.txt (add this to existing requirements)
Django==4.2.0
Pillow==10.0.0
django-allauth==0.54.0
google-auth==2.22.0
google-auth-oauthlib==1.0.0
google-auth-httplib2==0.1.0
qrcode==7.4.2
django-simple-translation==0.1.5

# ecommerce_project/settings.py (Updated for multilingual support)
import os
from pathlib import Path

BASE_DIR = Path(__file__).resolve().parent.parent

SECRET_KEY = 'your-secret-key-here'
DEBUG = True
ALLOWED_HOSTS = []

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django.contrib.sites',
    'allauth',
    'allauth.account',
    'allauth.socialaccount',
    'allauth.socialaccount.providers.google',
    'simple_translation',  # Add this
    'store',
    'accounts',
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.locale.LocaleMiddleware',  # Add this for language support
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'ecommerce_project.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
                'django.template.context_processors.i18n',  # Add this
            ],
        },
    },
]

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}

STATIC_URL = '/static/'
STATICFILES_DIRS = [BASE_DIR / 'static']

MEDIA_URL = '/media/'
MEDIA_ROOT = BASE_DIR / 'media'

SITE_ID = 1

# Language settings
from django.utils.translation import gettext_lazy as _

LANGUAGE_CODE = 'en'
TIME_ZONE = 'Asia/Bangkok'
USE_I18N = True
USE_L10N = True
USE_TZ = True

LANGUAGES = [
    ('en', _('English')),
    ('th', _('Thai')),
]

LOCALE_PATHS = [
    BASE_DIR / 'locale',
]

AUTHENTICATION_BACKENDS = [
    'django.contrib.auth.backends.ModelBackend',
    'allauth.account.auth_backends.AuthenticationBackend',
]

LOGIN_REDIRECT_URL = '/'
ACCOUNT_EMAIL_VERIFICATION = 'mandatory'
ACCOUNT_EMAIL_REQUIRED = True

SOCIALACCOUNT_PROVIDERS = {
    'google': {
        'SCOPE': [
            'profile',
            'email',
        ],
        'AUTH_PARAMS': {
            'access_type': 'online',
        }
    }
}

# templates/base.html (Updated with language switching)
<!DOCTYPE html>
{% load static %}
{% load i18n %}
<html lang="{% get_current_language as LANGUAGE_CODE %}{{ LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% trans "Fresh Market - Vegetables & Fruits" %}{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <style>
        .product-card {
            transition: transform 0.2s;
            cursor: pointer;
        }
        .product-card:hover {
            transform: translateY(-5px);
        }
        .price-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1;
        }
        .promotion-tag {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1;
        }
        .carousel-item img {
            height: 400px;
            object-fit: cover;
        }
        .navbar-brand {
            font-weight: bold;
            color: #28a745 !important;
        }
        .nav-tabs .nav-link.active {
            background-color: #28a745;
            border-color: #28a745;
            color: white;
        }
        .language-switcher {
            margin-left: 10px;
        }
        .language-switcher .dropdown-toggle {
            background: none;
            border: 1px solid #dee2e6;
            color: #495057;
        }
        .thai-font {
            font-family: 'Sarabun', 'Prompt', sans-serif;
        }
    </style>
    <!-- Thai fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="{% get_current_language as LANGUAGE_CODE %}{% if LANGUAGE_CODE == 'th' %}thai-font{% endif %}">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="{% url 'index' %}">
                <i class="bi bi-basket2-fill"></i> {% trans "Fresh Market" %}
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'index' %}">{% trans "Home" %}</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'admin_dashboard' %}">{% trans "Dashboard" %}</a>
                    </li>
                </ul>
                
                <ul class="navbar-nav">
                    <!-- Language Switcher -->
                    <li class="nav-item dropdown language-switcher">
                        <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            {% get_current_language as LANGUAGE_CODE %}
                            {% if LANGUAGE_CODE == 'th' %}
                                <i class="bi bi-translate"></i> ไทย
                            {% else %}
                                <i class="bi bi-translate"></i> English
                            {% endif %}
                        </button>
                        <ul class="dropdown-menu">
                            {% get_available_languages as LANGUAGES %}
                            {% get_current_language as LANGUAGE_CODE %}
                            {% for lang_code, lang_name in LANGUAGES %}
                                {% if lang_code != LANGUAGE_CODE %}
                                    <li>
                                        <form action="{% url 'set_language' %}" method="post" class="d-inline">
                                            {% csrf_token %}
                                            <input name="next" type="hidden" value="{{ redirect_to }}">
                                            <input name="language" type="hidden" value="{{ lang_code }}">
                                            <button type="submit" class="dropdown-item">
                                                {% if lang_code == 'th' %}
                                                    ไทย
                                                {% else %}
                                                    English
                                                {% endif %}
                                            </button>
                                        </form>
                                    </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    </li>
                    
                    {% if user.is_authenticated %}
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'cart' %}">
                                <i class="bi bi-cart"></i> {% trans "Cart" %}
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                                <i class="bi bi-person-circle"></i> {{ user.first_name|default:user.username }}
                                <span class="badge bg-success">{{ user.userprofile.points }} {% trans "pts" %}</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="{% url 'profile' %}">{% trans "Profile" %}</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'account_logout' %}">{% trans "Logout" %}</a></li>
                            </ul>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'account_login' %}">{% trans "Login" %}</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'register' %}">{% trans "Register" %}</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Messages -->
    {% if messages %}
        <div class="container mt-3">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Main Content -->
    <main>
        {% block content %}
        {% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white mt-5 py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>{% trans "Fresh Market" %}</h5>
                    <p>{% trans "Your trusted source for fresh vegetables and fruits." %}</p>
                </div>
                <div class="col-md-6">
                    <h5>{% trans "Contact Us" %}</h5>
                    <p>{% trans "Email" %}: info@freshmarket.com<br>
                    {% trans "Phone" %}: +66 123 456 789</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Product Detail Modal -->
    <div class="modal fade" id="productModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="productModalLabel">{% trans "Product Details" %}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="productModalBody">
                    <!-- Product details will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <script>
        // Product detail modal
        function showProductDetail(productId) {
            fetch(`/product/${productId}/`)
                .then(response => response.text())
                .then(html => {
                    document.getElementById('productModalBody').innerHTML = html;
                    new bootstrap.Modal(document.getElementById('productModal')).show();
                });
        }

        // Update cart item quantity
        function updateCartQuantity(itemId, quantity) {
            fetch('/update-cart-item/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: JSON.stringify({
                    item_id: itemId,
                    quantity: quantity
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                }
            });
        }
    </script>
    
    {% block extra_js %}
    {% endblock %}
</body>
</html>

# templates/admin/admin_dashboard.html (New dashboard using base.html)
{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Admin Dashboard" %} - {% trans "Fresh Market" %}{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Dashboard Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h2><i class="bi bi-speedometer2"></i> {% trans "Admin Dashboard" %}</h2>
                            <p class="mb-0">{% trans "Monitor your e-commerce performance" %}</p>
                        </div>
                        <div class="text-end">
                            <p class="mb-0">{% trans "Welcome back" %}, {{ user.first_name|default:user.username }}!</p>
                            <small>{% now "F d, Y" %}</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card bg-success text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h3>{{ total_products }}</h3>
                            <p class="mb-0">{% trans "Total Products" %}</p>
                        </div>
                        <i class="bi bi-box-seam display-4"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-info text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h3>{{ total_users }}</h3>
                            <p class="mb-0">{% trans "Total Users" %}</p>
                        </div>
                        <i class="bi bi-people display-4"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-warning text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h3>{{ total_orders }}</h3>
                            <p class="mb-0">{% trans "Total Orders" %}</p>
                            <small>{{ pending_orders }} {% trans "pending" %}</small>
                        </div>
                        <i class="bi bi-bag-check display-4"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-danger text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h3>
                                {% get_current_language as LANGUAGE_CODE %}
                                {% if LANGUAGE_CODE == 'th' %}
                                    ฿{{ total_revenue|floatformat:0 }}
                                {% else %}
                                    ${{ total_revenue|floatformat:2 }}
                                {% endif %}
                            </h3>
                            <p class="mb-0">{% trans "Total Revenue" %}</p>
                        </div>
                        <i class="bi bi-currency-dollar display-4"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Revenue Overview -->
    <div class="row mb-4">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5><i class="bi bi-graph-up"></i> {% trans "Revenue Overview" %}</h5>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-md-4">
                            <h4 class="text-success">
                                {% get_current_language as LANGUAGE_CODE %}
                                {% if LANGUAGE_CODE == 'th' %}
                                    ฿{{ weekly_revenue|floatformat:0 }}
                                {% else %}
                                    ${{ weekly_revenue|floatformat:2 }}
                                {% endif %}
                            </h4>
                            <p class="text-muted">{% trans "This Week" %}</p>
                        </div>
                        <div class="col-md-4">
                            <h4 class="text-info">
                                {% get_current_language as LANGUAGE_CODE %}
                                {% if LANGUAGE_CODE == 'th' %}
                                    ฿{{ monthly_revenue|floatformat:0 }}
                                {% else %}
                                    ${{ monthly_revenue|floatformat:2 }}
                                {% endif %}
                            </h4>
                            <p class="text-muted">{% trans "This Month" %}</p>
                        </div>
                        <div class="col-md-4">
                            <h4 class="text-primary">
                                {% get_current_language as LANGUAGE_CODE %}
                                {% if LANGUAGE_CODE == 'th' %}
                                    ฿{{ total_revenue|floatformat:0 }}
                                {% else %}
                                    ${{ total_revenue|floatformat:2 }}
                                {% endif %}
                            </h4>
                            <p class="text-muted">{% trans "All Time" %}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5><i class="bi bi-exclamation-triangle"></i> {% trans "Low Stock Alert" %}</h5>
                </div>
                <div class="card-body">
                    {% if low_stock_products %}
                        {% for option in low_stock_products %}
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <small>{{ option.product.name }} ({{ option.get_package_type_display }})</small>
                                <span class="badge bg-warning">{{ option.stock_quantity }}</span>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-muted">{% trans "All products are well stocked!" %}</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Popular Products and Recent Orders -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5><i class="bi bi-star"></i> {% trans "Popular Products" %}</h5>
                </div>
                <div class="card-body">
                    {% for product in popular_products %}
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <strong>{{ product.name }}</strong>
                                <br><small class="text-muted">{{ product.category.name }}</small>
                            </div>
                            <span class="badge bg-success">{{ product.order_count }} {% trans "orders" %}</span>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5><i class="bi bi-clock-history"></i> {% trans "Recent Orders" %}</h5>
                </div>
                <div class="card-body">
                    {% for order in recent_orders %}
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <strong>#{{ order.order_number }}</strong>
                                <br><small class="text-muted">{{ order.user.username }}</small>
                            </div>
                            <div class="text-end">
                                <div>
                                    {% get_current_language as LANGUAGE_CODE %}
                                    {% if LANGUAGE_CODE == 'th' %}
                                        ฿{{ order.total_amount }}
                                    {% else %}
                                        ${{ order.total_amount }}
                                    {% endif %}
                                </div>
                                <span class="badge 
                                    {% if order.status == 'pending' %}bg-warning
                                    {% elif order.status == 'processing' %}bg-info
                                    {% elif order.status == 'shipped' %}bg-primary
                                    {% elif order.status == 'delivered' %}bg-success
                                    {% else %}bg-danger{% endif %}">
                                    {% trans order.get_status_display %}
                                </span>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5><i class="bi bi-lightning"></i> {% trans "Quick Actions" %}</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-2 mb-3">
                            <a href="/admin/store/product/add/" class="btn btn-success w-100">
                                <i class="bi bi-plus-circle"></i><br>{% trans "Add Product" %}
                            </a>
                        </div>
                        <div class="col-md-2 mb-3">
                            <a href="/admin/store/promotion/add/" class="btn btn-danger w-100">
                                <i class="bi bi-percent"></i><br>{% trans "Create Promotion" %}
                            </a>
                        </div>
                        <div class="col-md-2 mb-3">
                            <a href="/admin/store/order/" class="btn btn-info w-100">
                                <i class="bi bi-bag-check"></i><br>{% trans "Manage Orders" %}
                            </a>
                        </div>
                        <div class="col-md-2 mb-3">
                            <a href="/admin/accounts/userprofile/" class="btn btn-warning w-100">
                                <i class="bi bi-people"></i><br>{% trans "Manage Users" %}
                            </a>
                        </div>
                        <div class="col-md-2 mb-3">
                            <a href="/admin/store/sitesettings/" class="btn btn-secondary w-100">
                                <i class="bi bi-gear"></i><br>{% trans "Site Settings" %}
                            </a>
                        </div>
                        <div class="col-md-2 mb-3">
                            <a href="/admin/store/carouselimage/" class="btn btn-primary w-100">
                                <i class="bi bi-images"></i><br>{% trans "Carousel Images" %}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Back to Admin -->
    <div class="text-center mb-5">
        <a href="/admin/" class="btn btn-outline-primary">
            <i class="bi bi-arrow-left"></i> {% trans "Back to Admin Panel" %}
        </a>
    </div>
</div>
{% endblock %}

# ecommerce_project/urls.py (Updated to include language switching)
from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static
from django.conf.urls.i18n import i18n_patterns

# Non-translatable URLs (like admin, API endpoints)
urlpatterns = [
    path('admin/', admin.site.urls),
    path('i18n/', include('django.conf.urls.i18n')),  # Language switching URLs
]

# Translatable URLs
urlpatterns += i18n_patterns(
    path('', include('store.urls')),
    path('accounts/', include('accounts.urls')),
    path('accounts/', include('allauth.urls')),
)

if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
    urlpatterns += static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)

# store/views.py (Updated admin dashboard view)
from django.shortcuts import render
from django.contrib.admin.views.decorators import staff_member_required
from django.db.models import Sum, Count
from django.utils import timezone
from datetime import timedelta
from .models import *
from accounts.models import *

@staff_member_required
def admin_dashboard(request):
    """Custom admin dashboard with statistics"""
    
    # Get date ranges
    today = timezone.now().date()
    week_ago = today - timedelta(days=7)
    month_ago = today - timedelta(days=30)
    
    # Basic statistics
    total_products = Product.objects.filter(is_active=True).count()
    total_users = User.objects.count()
    total_orders = Order.objects.count()
    pending_orders = Order.objects.filter(status='pending').count()
    
    # Revenue statistics
    total_revenue = Order.objects.exclude(status='cancelled').aggregate(
        total=Sum('total_amount'))['total'] or 0
    
    weekly_revenue = Order.objects.filter(
        created_at__gte=week_ago,
        status__in=['processing', 'shipped', 'delivered']
    ).aggregate(total=Sum('total_amount'))['total'] or 0
    
    monthly_revenue = Order.objects.filter(
        created_at__gte=month_ago,
        status__in=['processing', 'shipped', 'delivered']
    ).aggregate(total=Sum('total_amount'))['total'] or 0
    
    # Product statistics
    low_stock_products = ProductOption.objects.filter(stock_quantity__lt=10)
    
    # Popular products (based on order frequency)
    popular_products = Product.objects.annotate(
        order_count=Count('options__orderitem')
    ).order_by('-order_count')[:5]
    
    # Recent orders
    recent_orders = Order.objects.order_by('-created_at')[:10]
    
    context = {
        'total_products': total_products,
        'total_users': total_users,
        'total_orders': total_orders,
        'pending_orders': pending_orders,
        'total_revenue': total_revenue,
        'weekly_revenue': weekly_revenue,
        'monthly_revenue': monthly_revenue,
        'low_stock_products': low_stock_products,
        'popular_products': popular_products,
        'recent_orders': recent_orders,
    }
    
    return render(request, 'admin/admin_dashboard.html', context)

# store/urls.py (Updated to include dashboard)
from django.urls import path
from . import views

urlpatterns = [
    path('', views.index, name='index'),
    path('dashboard/', views.admin_dashboard, name='admin_dashboard'),
    path('product/<int:product_id>/', views.product_detail, name='product_detail'),
    path('add-to-cart/', views.add_to_cart, name='add_to_cart'),
    path('cart/', views.cart, name='cart'),
    path('checkout/', views.checkout, name='checkout'),
    path('process-checkout/', views.process_checkout, name='process_checkout'),
    path('payment/<int:order_id>/', views.payment, name='payment'),
    path('update-cart-item/', views.update_cart_item, name='update_cart_item'),
    path('remove-from-cart/<int:item_id>/', views.remove_from_cart, name='remove_from_cart'),
]

# Create translation files structure:
# locale/th/LC_MESSAGES/django.po (Thai translations)
# You need to create this directory structure:
# locale/
# ├── th/
# │   └── LC_MESSAGES/
# │       ├── django.po
# │       └── django.mo
# └── en/
#     └── LC_MESSAGES/
#         ├── django.po
#         └── django.mo

# Management commands to generate translation files:
# 1. Create locale directory
# mkdir -p locale/th/LC_MESSAGES
# mkdir -p locale/en/LC_MESSAGES

# 2. Generate translation files
# python manage.py makemessages -l th
# python manage.py makemessages -l en

# 3. Compile translations
# python manage.py compilemessages

# Sample Thai translations for locale/th/LC_MESSAGES/django.po
msgid ""
msgstr ""
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Language: th\n"

msgid "Fresh Market - Vegetables & Fruits"
msgstr "เฟรชมาร์เก็ต - ผักและผลไม้"

msgid "Fresh Market"
msgstr "เฟรชมาร์เก็ต"

msgid "Home"
msgstr "หน้าแรก"

msgid "Dashboard"
msgstr "แดชบอร์ด"

msgid "Cart"
msgstr "ตะกร้า"

msgid "Profile"
msgstr "โปรไฟล์"

msgid "Logout"
msgstr "ออกจากระบบ"

msgid "Login"
msgstr "เข้าสู่ระบบ"

msgid "Register"
msgstr "สมัครสมาชิก"

msgid "pts"
msgstr "คะแนน"

msgid "Your trusted source for fresh vegetables and fruits."
msgstr "แหล่งผักและผลไม้สดใหม่ที่คุณไว้วางใจ"

msgid "Contact Us"
msgstr "ติดต่อเรา"

msgid "Email"
msgstr "อีเมล"

msgid "Phone"
msgstr "โทรศัพท์"

msgid "Product Details"
msgstr "รายละเอียดสินค้า"

msgid "Admin Dashboard"
msgstr "แดชบอร์ดผู้ดูแลระบบ"

msgid "Monitor your e-commerce performance"
msgstr "ติดตามประสิทธิภาพร้านค้าออนไลน์ของคุณ"

msgid "Welcome back"
msgstr "ยินดีต้อนรับกลับ"

msgid "Total Products"
msgstr "สินค้าทั้งหมด"

msgid "Total Users"
msgstr "ผู้ใช้ทั้งหมด"

msgid "Total Orders"
msgstr "คำสั่งซื้อทั้งหมด"

msgid "pending"
msgstr "รอดำเนินการ"

msgid "Total Revenue"
msgstr "รายได้ทั้งหมด"

msgid "Revenue Overview"
msgstr "ภาพรวมรายได้"

msgid "This Week"
msgstr "สัปดาห์นี้"

msgid "This Month"
msgstr "เดือนนี้"

msgid "All Time"
msgstr "ตลอดเวลา"

msgid "Low Stock Alert"
msgstr "แจ้งเตือนสินค้าใกล้หมด"

msgid "All products are well stocked!"
msgstr "สินค้าทุกชนิดมีสต็อกเพียงพอ!"

msgid "Popular Products"
msgstr "สินค้ายอดนิยม"

msgid "orders"
msgstr "คำสั่งซื้อ"

msgid "Recent Orders"
msgstr "คำสั่งซื้อล่าสุด"

msgid "Quick Actions"
msgstr "การดำเนินการด่วน"

msgid "Add Product"
msgstr "เพิ่มสินค้า"

msgid "Create Promotion"
msgstr "สร้างโปรโมชั่น"

msgid "Manage Orders"
msgstr "จัดการคำสั่งซื้อ"

msgid "Manage Users"
msgstr "จัดการผู้ใช้"

msgid "Site Settings"
msgstr "ตั้งค่าเว็บไซต์"

msgid "Carousel Images"
msgstr "รูปภาพสไลด์"

msgid "Back to Admin Panel"
msgstr "กลับไปแผงผู้ดูแลระบบ"

msgid "Vegetables"
msgstr "ผัก"

msgid "Fruits"
msgstr "ผลไม้"

msgid "Others"
msgstr "อื่นๆ"

msgid "Add to Cart"
msgstr "เพิ่มลงตะกร้า"

msgid "Quantity"
msgstr "จำนวน"

msgid "Price"
msgstr "ราคา"

msgid "Total"
msgstr "รวม"

msgid "Checkout"
msgstr "ชำระเงิน"

msgid "Order Summary"
msgstr "สรุปคำสั่งซื้อ"

msgid "Subtotal"
msgstr "รวมย่อย"

msgid "Points Discount"
msgstr "ส่วนลดคะแนน"

msgid "Place Order"
msgstr "สั่งซื้อ"

msgid "Order Confirmation"
msgstr "ยืนยันคำสั่งซื้อ"

msgid "Payment Details"
msgstr "รายละเอียดการชำระเงิน"

msgid "Bank Transfer Details"
msgstr "รายละเอียดการโอนเงิน"

msgid "Order Items"
msgstr "รายการสินค้า"

msgid "Package"
msgstr "แพ็คเกจ"

msgid "Payment Instructions"
msgstr "คำแนะนำการชำระเงิน"

msgid "Continue Shopping"
msgstr "เลือกซื้อต่อ"

msgid "View Orders"
msgstr "ดูคำสั่งซื้อ"

# templates/store/index.html (Updated with translations)
{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block content %}
<div class="container-fluid px-0">
    <!-- Carousel -->
    <div id="homeCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            {% for image in carousel_images %}
                <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="{{ forloop.counter0 }}" 
                        {% if forloop.first %}class="active"{% endif %}></button>
            {% endfor %}
        </div>
        
        <div class="carousel-inner">
            {% for image in carousel_images %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <img src="{{ image.image.url }}" class="d-block w-100" alt="{{ image.title }}">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>{{ image.title }}</h5>
                    </div>
                </div>
            {% endfor %}
        </div>
        
        <button class="carousel-control-prev" type="button" data-bs-target="#homeCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#homeCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>
</div>

<div class="container mt-5">
    <!-- Product Tabs -->
    <ul class="nav nav-tabs" id="productTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="vegetables-tab" data-bs-toggle="tab" data-bs-target="#vegetables" 
                    type="button" role="tab">
                <i class="bi bi-basket"></i> {% trans "Vegetables" %}
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="fruits-tab" data-bs-toggle="tab" data-bs-target="#fruits" 
                    type="button" role="tab">
                <i class="bi bi-apple"></i> {% trans "Fruits" %}
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="others-tab" data-bs-toggle="tab" data-bs-target="#others" 
                    type="button" role="tab">
                <i class="bi bi-box"></i> {% trans "Others" %}
            </button>
        </li>
    </ul>

    <div class="tab-content" id="productTabsContent">
        <!-- Vegetables Tab -->
        <div class="tab-pane fade show active" id="vegetables" role="tabpanel">
            <div class="row mt-4">
                {% for product in vegetables %}
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="card product-card h-100" onclick="showProductDetail({{ product.id }})">
                            <div class="position-relative">
                                <img src="{{ product.image.url }}" class="card-img-top" alt="{{ product.name }}" style="height: 200px; object-fit: cover;">
                                
                                <!-- Promotion Tag -->
                                {% for promo in active_promotions %}
                                    {% if promo.product == product %}
                                        <span class="badge bg-danger promotion-tag">{{ promo.promotion.tag_text }}</span>
                                    {% endif %}
                                {% endfor %}
                                
                                <!-- Price Badge -->
                                <div class="price-badge">
                                    {% for promo in active_promotions %}
                                        {% if promo.product == product %}
                                            <span class="badge bg-success">
                                                {% get_current_language as LANGUAGE_CODE %}
                                                {% if LANGUAGE_CODE == 'th' %}
                                                    ฿{{ promo.promotional_price }}
                                                {% else %}
                                                    ${{ promo.promotional_price }}
                                                {% endif %}
                                            </span>
                                            <br><small class="text-muted">
                                                <s>
                                                    {% if LANGUAGE_CODE == 'th' %}
                                                        ฿{{ product.base_price }}
                                                    {% else %}
                                                        ${{ product.base_price }}
                                                    {% endif %}
                                                </s>
                                            </small>
                                        {% else %}
                                            <span class="badge bg-primary">
                                                {% if LANGUAGE_CODE == 'th' %}
                                                    ฿{{ product.base_price }}
                                                {% else %}
                                                    ${{ product.base_price }}
                                                {% endif %}
                                            </span>
                                        {% endif %}
                                    {% empty %}
                                        <span class="badge bg-primary">
                                            {% if LANGUAGE_CODE == 'th' %}
                                                ฿{{ product.base_price }}
                                            {% else %}
                                                ${{ product.base_price }}
                                            {% endif %}
                                        </span>
                                    {% endfor %}
                                </div>
                            </div>
                            
                            <div class="card-body">
                                <h6 class="card-title">{{ product.name }}</h6>
                                <p class="card-text text-muted small">{{ product.description|truncatewords:10 }}</p>
                                <small class="text-success">
                                    <i class="bi bi-star-fill"></i> {{ product.points }} {% trans "pts" %}
                                </small>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>

        <!-- Similar updates for Fruits and Others tabs -->
        <div class="tab-pane fade" id="fruits" role="tabpanel">
            <!-- Fruits content with translated labels -->
        </div>

        <div class="tab-pane fade" id="others" role="tabpanel">
            <!-- Others content with translated labels -->
        </div>
    </div>
</div>
{% endblock %}

# templates/store/product_detail.html (Updated with translations)
{% load i18n %}
<div class="row">
    <div class="col-md-6">
        <img src="{{ product.image.url }}" class="img-fluid rounded" alt="{{ product.name }}">
    </div>
    <div class="col-md-6">
        <h4>{{ product.name }}</h4>
        <p class="text-muted">{{ product.description }}</p>
        
        {% if promotion %}
            <div class="alert alert-success">
                <strong>{{ promotion.promotion.tag_text }}!</strong> 
                {% trans "Special price" %}: 
                {% get_current_language as LANGUAGE_CODE %}
                {% if LANGUAGE_CODE == 'th' %}
                    ฿{{ promotion.promotional_price }}
                {% else %}
                    ${{ promotion.promotional_price }}
                {% endif %}
                <small class="text-muted">
                    <s>{% trans "Was" %}: 
                        {% if LANGUAGE_CODE == 'th' %}
                            ฿{{ product.base_price }}
                        {% else %}
                            ${{ product.base_price }}
                        {% endif %}
                    </s>
                </small>
            </div>
        {% endif %}
        
        <form method="post" action="{% url 'add_to_cart' %}">
            {% csrf_token %}
            
            <div class="mb-3">
                <label for="package_options" class="form-label">{% trans "Package Options" %}:</label>
                <div id="package_options">
                    {% for option in options %}
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="product_option_id" 
                                   id="option{{ option.id }}" value="{{ option.id }}" 
                                   {% if forloop.first %}checked{% endif %}>
                            <label class="form-check-label" for="option{{ option.id }}">
                                <strong>{{ option.get_package_type_display }}</strong> ({{ option.weight }}) - 
                                <span class="text-success">
                                    {% get_current_language as LANGUAGE_CODE %}
                                    {% if LANGUAGE_CODE == 'th' %}
                                        ฿{{ option.price }}
                                    {% else %}
                                        ${{ option.price }}
                                    {% endif %}
                                </span>
                                {% if option.stock_quantity > 0 %}
                                    <small class="text-muted">({{ option.stock_quantity }} {% trans "available" %})</small>
                                {% else %}
                                    <small class="text-danger">({% trans "Out of stock" %})</small>
                                {% endif %}
                            </label>
                        </div>
                    {% endfor %}
                </div>
            </div>
            
            <div class="mb-3">
                <label for="quantity" class="form-label">{% trans "Quantity" %}:</label>
                <div class="input-group" style="width: 150px;">
                    <button class="btn btn-outline-secondary" type="button" onclick="decreaseQuantity()">-</button>
                    <input type="number" class="form-control text-center" id="quantity" name="quantity" 
                           value="1" min="1" max="10">
                    <button class="btn btn-outline-secondary" type="button" onclick="increaseQuantity()">+</button>
                </div>
            </div>
            
            <div class="mb-3">
                <small class="text-success">
                    <i class="bi bi-star-fill"></i> {% trans "Earn" %} {{ product.points }} {% trans "points per item" %}
                </small>
            </div>
            
            <div class="d-grid gap-2">
                {% if user.is_authenticated %}
                    <button type="submit" class="btn btn-success">
                        <i class="bi bi-cart-plus"></i> {% trans "Add to Cart" %}
                    </button>
                {% else %}
                    <a href="{% url 'account_login' %}" class="btn btn-primary">
                        {% trans "Login to Purchase" %}
                    </a>
                {% endif %}
            </div>
        </form>
    </div>
</div>

<script>
function increaseQuantity() {
    const qty = document.getElementById('quantity');
    if (parseInt(qty.value) < 10) {
        qty.value = parseInt(qty.value) + 1;
    }
}

function decreaseQuantity() {
    const qty = document.getElementById('quantity');
    if (parseInt(qty.value) > 1) {
        qty.value = parseInt(qty.value) - 1;
    }
}
</script>

# Setup instructions for multilingual support
# 1. Install django-simple-translation
pip install django-simple-translation

# 2. Create locale directories
mkdir -p locale/th/LC_MESSAGES
mkdir -p locale/en/LC_MESSAGES

# 3. Generate translation files
python manage.py makemessages -l th
python manage.py makemessages -l en

# 4. Edit the generated .po files to add translations
# locale/th/LC_MESSAGES/django.po - Add Thai translations
# locale/en/LC_MESSAGES/django.po - English translations (default)

# 5. Compile translation files
python manage.py compilemessages

# 6. Test language switching
# Visit your site and use the language switcher in the navigation

# Additional template updates for other pages
# You can apply similar translation patterns to:
# - templates/store/cart.html
# - templates/store/checkout.html
# - templates/store/payment.html
# - templates/accounts/login.html
# - templates/accounts/register.html
# - templates/accounts/profile.html

# Example for cart.html header:
{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Shopping Cart" %} - {% trans "Fresh Market" %}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2><i class="bi bi-cart"></i> {% trans "Shopping Cart" %}</h2>
    <!-- Rest of cart content with translated strings -->
</div>
{% endblock %}
